zephyr_include_directories(.)

function(custom_library library_name sources)
  zephyr_library_named(${library_name})
  zephyr_library_sources(${sources} ${ARGN})
  # Depend on the public Zephyr interface
  target_link_libraries(${library_name} PRIVATE zephyr_interface)
  # That's some magic to build autogenerated headers.
  # See https://lists.zephyrproject.org/g/devel/message/5475.
  add_dependencies(${library_name} offsets_h)
endfunction()

custom_library(cc1101 cc1101.cpp)
custom_library(color color.cpp)
custom_library(timer timer.cpp)
custom_library(battery battery.cpp)

if(CONFIG_BT)
  custom_library(bluetooth bluetooth.cpp)
endif()

custom_library(buzzer buzzer.cpp)
target_link_libraries(buzzer PRIVATE timer)

custom_library(rgb_led rgb_led.cpp)
target_link_libraries(rgb_led PRIVATE color timer)